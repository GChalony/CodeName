<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Code Name</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/grid.css') }}">
</head>
<body>
    <h1 id="toptitle">{{ title }}</h1>
    <div id="container">
        <div id="players">
            {% for i in [1, 2] %}
                {% for player in teams[i-1] %}
                <span
                        id="{{ player.id }}"
                        data-team="{{ ''~i }}"
                        class="pseudo{% if player.id==current_spy %} current-player{% endif %}">
                    {{ player.pseudo }}
                </span>
                {% endfor %}
            {% endfor %}
        </div>
        <div id="center">
            <table id="table">
                {% for r in range(5) %}
                <tr>
                    {% for c in range(5) %}
                    {% set cell = 'r'~r~'c'~c %}
                    <td id="{{ cell }}"
                        data-votedfor="{%if votes_history[cell] is defined %}true{% else %}false{% endif %}"
                        data-code="{% if is_spy %}{{ answers[r][c] }}{% elif votes_history[cell] is defined %}{{ votes_history[cell] }}{% else %}-1{% endif %}"
                        data-enabled="false"
                    >
                        {{words[r, c]}} </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </table>

            {% if is_spy %}
            <form id="controls">
                <input id="hint" type="text">
                <input id="n" type="number" min="0" max="9">
                <input id="send-hint" type="submit" {% if not spy_enabled %}disabled{% endif %}>
            </form>
            {% else %}
            <input id="pass" type="submit">
            {% endif %}
        </div>
        <div id="chats">
            <div id="events">
                <ul id="events_msglist" class="msglist">
                    {% for msg in events_history %}
                    <li>{{ msg }}</li>
                    {% endfor %}
                </ul>
            </div>
            <div id="chat">
                <ul id="messages" class="msglist">
                    {% for msg in chat_history %}
                    <li>{{ msg }}</li>
                    {% endfor %}
                </ul>
                <form id="msgform">
                    <input type="text" id="m" autocomplete="off">
                    <input type="submit" id="s" value=">">
                </form>
            </div>
        </div>
    </div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='js/grid/grid_controls.js') }}"></script>
    {% if is_spy %}<script src="{{ url_for('static', filename='js/grid/spy.js') }}"></script>
    {% else %}<script src="{{ url_for('static', filename='js/grid/guesser.js') }}"></script>{% endif %}
    <script src="{{ url_for('static', filename='js/grid/chat.js') }}"></script>
    <script src="{{ url_for('static', filename='js/grid/events_chat.js') }}"></script>
</body>
</html>